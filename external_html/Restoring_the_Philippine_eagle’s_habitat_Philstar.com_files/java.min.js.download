var rec_top, geocoder, white_ready = !1, social_ready = !1, ifhide = 1, base_url = "https://" + window.location.hostname + "/"; function whiteout_reset() { $("#whiteout").fadeIn(200, function () { white_ready = !0 }), $("#floatingBarsG").css({ display: "block" }), $("#popup, #login, #logout, #splash_ad").css({ display: "none" }) } function call_google(e) { console.log(window.location.href); var o = window.location.href; ga("set", { page: o }), ga("send", "pageview"), ga("send", "event", e, "scroll page", o) } function resize_code() { "block" == $("#mobile_icons").css("display") ? $(".titleForOpinion").width($(".tiles").width() - $(".article_columnist").width() - 38) : $(".titleForOpinion").width(160) } function right_side_sticky() { win = $(window), micRigSid = $("#sidebar"), micRigSid.length > 0 && (elemL = micRigSid.find("#sidebar_padding"), stiRig = micRigSid.offset().top + micRigSid.height(), winScr = win.scrollTop() + win.height(), winScr >= stiRig ? elemL.hasClass("locked-bottom") || (micRigSid.css({ "min-height": elemL.height() + "px" }), elemL.addClass("locked-bottom").css({ bottom: "0", width: micRigSid.width() + "px" })) : elemL.hasClass("locked-bottom") && elemL.removeClass("locked-bottom").css({ bottom: "initial" })) } function go_search(e) { var o = encodeURIComponent($("#" + e).val()); window.location.assign(base_url + "search/" + o) } function getLocation() { console.log("get location"), geocoder = new google.maps.Geocoder, navigator.geolocation ? (console.log(navigator.geolocation), navigator.geolocation.getCurrentPosition(showPosition, showError)) : console.log("no location") } function showPosition(e) { console.log("position"); var o = new google.maps.LatLng(e.coords.latitude, e.coords.longitude); geocoder.geocode({ latLng: o }, function (e, o) { if (console.log("status: " + o), o == google.maps.GeocoderStatus.OK) if (console.log("position: " + e), e[1]) { for (var i = 0; i < e[0].address_components.length; i++)for (var s = 0; s < e[0].address_components[i].types.length; s++)if ("locality" == e[0].address_components[i].types[s]) { city = e[0].address_components[i]; break } $.post(base_url + "geoarts.php", "short=" + city.short_name + "&long=" + city.long_name, function (e) { "0" != e && ($("#geo").append(e), "relative" == $("#static_cells").css("position") && 0 == rec_top && (rec_top = $("#static_cells").offset().top)) }) } else $("#offset").text("No results found"); else $("#offset").text("Geocoder failed due to: " + o) }) } function showError(e) { var o; switch (e.code) { case e.PERMISSION_DENIED: o = "User denied the request for Geolocation."; break; case e.POSITION_UNAVAILABLE: o = "Location information is unavailable."; break; case e.TIMEOUT: o = "The request to get user location timed out."; break; case e.UNKNOWN_ERROR: o = "An unknown error occurred." }console.log("error: " + o) } $(function () { var e; $("#cookie-button").click(function () { $("#cookie-message").slideUp(200), $.post(base_url + "suppress.php", "", function () { }) }), $("#unread_bites, #unread_bites_mobile, #unread_bites_tiny").click(function () { $("#nav_unread").slideToggle(200) }), $(".nav_unread_check_button").click(function () { var e = $(this).attr("targ"); $(this).css({ backgroundPosition: "0 -13px" }), $.post("mark_read.php", "targ=" + e, function (o) { $("#unread_bites").text(parseInt($("#unread_bites").text()) - 1), $(".entry" + e).slideUp(200, function () { $(".entry" + e).remove() }) }) }), $("#has_subnav").click(function (e) { e.preventDefault(), $("#mobile-navig").slideUp(200), $(".mobile-navig_subnav").slideDown(200) }), $("#backtotop").click(function () { window.scrollTo(0, 0) }), $("#popup_close").click(function () { $("#whiteout").fadeOut(200), white_ready = !1 }), rec_top = $("#static_cells").offset().top, $("#user_login, .register-now").click(function () { $("body").css({ overflow: "hidden" }), whiteout_reset(), $("#floatingBarsG").css({ display: "none" }), $("#login").css({ display: "block" }) }), $(document).on("click", function (e) { (0 == $(e.target).closest("#login").length && "block" == $("#login").css("display") || 0 == $(e.target).closest("#logout").length && "block" == $("#logout").css("display") || 0 == $(e.target).closest("#splash_ad").length && "block" == $("#splash_ad").css("display")) && !0 === white_ready && ($("#whiteout").fadeOut(200), $("#splash_ad_container").fadeOut(200), $("body").css({ overflow: "initial" }), white_ready = !1) }), $("#login_close").click(function () { $("#whiteout").fadeOut(200), white_ready = !1, $("body").css({ overflow: "initial" }) }), resize_code(), right_side_sticky(), $(window).resize(function () { right_side_sticky(), $(".mobile_hide").css({ display: "none" }), $("#mobile_burger_drop").width($("#content").width()), "none" == $("#section_checker").css("display") ? ($(".tiles").css({ display: "inline-block" }), $(".typeNews").css({ display: "block" })) : $(".section_switcher").each(function () { if ($(this).hasClass("active")) { var e = $(this).attr("targ"); $(".tiles, .typeNews").css({ display: "none" }), "articles" == e ? ($("#articles").css({ display: "inline-block" }), $("#sidebar").css({ display: "none" })) : "columnist" == e ? ($("#articles").css({ display: "none" }), $("#sidebar").css({ display: "inline-block" })) : ($(".typeNews").css({ display: "none" }), $("." + e).css({ display: "inline-block" })) } }), resize_code() }), $(window).scroll(function () { right_side_sticky(); var e, o, i, s = parseInt($("#header").height()); $(document).scrollTop() > 50 ? $("#backtotop").addClass("active") : $("#backtotop").removeClass("active"), e = "null" == String($("#carousel_news").height()) ? $("#header").height() + $(".theLeaderBoard").height() + 20 + $("#sports_header").height() + $(".padding").height() + 60 + 20 : $("#header").height() + $(".theLeaderBoard").height() + 20 + $("#slide_holder").height(), "none" == $("#section_checker").css("display") ? (o = $("#fixed_anchor").offset().top - parseInt($("#header").height()) - 15, "fixed" == $(".header_subnav").css("position") && "none" == $("#mobile_icons").css("display") ? (o += parseInt($(".header_subnav").height()), $("#fixed_news_headings").css({ top: parseInt($("#header").height()) + "px" })) : $("#fixed_news_headings").css({ top: parseInt($("#header").height()) + "px" })) : o = 9999999, console.log($(document).scrollTop() + ", " + o + ", " + e), $(document).scrollTop() >= e ? ($("#section_checker").css({ position: "fixed", top: $("#header").height() + "px" }), "" != (i = $("#history").val()) && History.pushState(null, $("#history").attr("targ"), i)) : ($("#section_checker").css({ position: "relative", top: "0px" }), "" != (i = $("#original").val()) && History.pushState(null, null, i)), $(document).scrollTop() >= o ? $("#fixed_news_headings").show() : $("#fixed_news_headings").hide(), "none" != $("#sidebar").css("display") && $(document).scrollTop() + s >= rec_top && ("block" == $("#mobile_icons").css("display") && $("#header").height(), $(".header_subnav").css("display")) }), $(".comment_tab").click(function () { $(".comment_tab").removeClass("active"), $(this).addClass("active"), $(".comments_area").css({ display: "none" }), $("#comments_" + $(this).attr("targ")).css({ display: "block" }) }), $("#ps_email, #ps_password").keypress(function (e) { 13 == e.which && login_user() }), $("#login_button").click(function () { login_user() }), $(".header_subnav_cell").hover(function () { clearTimeout(e), $(".header_trinav_contents").slideUp(200), $(this).find(".header_trinav_contents").slideDown(200) }, function () { var o = $(this); e = setTimeout(function () { o.find(".header_trinav_contents").slideUp(200) }, 500) }), $(".mobile_expand a").click(function (e) { e.preventDefault(), "+" == $(this).text() ? $(this).text("-") : $(this).text("+"), $(this).parent().parent().find(".mobile_trinav_contents").each(function () { $(this).slideToggle(200) }) }), $(document).keyup(function (e) { 27 == e.keyCode && "block" == $("#searchbar").css("display") && ($("#nav_profile").slideUp(200), $("#searchbar").toggle("slide", { direction: "up" }, 200), social_ready = !1) }), $("#searchbar_close").click(function () { $("#nav_profile").slideUp(200), $("#searchbar").toggle("slide", { direction: "up" }, 200), social_ready = !1 }), $("#user_logout, #logout_yes, #profile_logout").click(function () { console.log("log out"), whiteout_reset(), $.post(base_url + "logout.php", "", function () { console.log("logged out"), location.reload() }) }), $("#logout_no").click(function () { $("#whiteout").fadeOut(200), white_ready = !1 }), $("#search_toggle").click(function () { $("#nav_profile").slideUp(200), $("#searchbar").toggle("slide", { direction: "up" }, 200, function () { console.log("searchbar: " + $("#searchbar").css("display")), "none" != $("#searchbar").css("display") && $("#search_field").focus() }), social_ready = !1 }), $("#search_field").keypress(function (e) { 13 == e.which && "" != $("#search_field").val() && go_search("search_field") }), $("#mobile_search_field").keypress(function (e) { 13 == e.which && "" != $("#mobile_search_field").val() && go_search("mobile_search_field") }), $(".mobile_icon, .mobile_icon_tiny").click(function (e) { e.preventDefault(); var o = $(this).prop("id"); $(".mobile_hide").each(function () { "block" == $(this).css("display") && $(this).prop("id") != o + "_drop" && $(this).slideUp(200) }), "mobile_login" == o ? ($("body").css({ overflow: "hidden" }), whiteout_reset(), $("#floatingBarsG").css({ display: "none" }), $("#login").css({ display: "block" })) : "mobile_logout" == o ? window.location.assign(base_url + "profile") : "mobile_search" == o && ($("#search_field").val(), $("#nav_profile").slideUp(200), $("#searchbar").toggle("slide", { direction: "up" }, 200), social_ready = !1) }), $(".section_switcher").click(function () { $(".section_switcher").removeClass("active"), $(this).addClass("active"); var e = $(this).attr("targ"); $(".tiles, .typeNews").css({ display: "none" }), "articles" == e ? ($("#articles").css({ display: "inline-block" }), $("#sidebar").css({ display: "none" })) : "columnist" == e ? ($("#articles").css({ display: "none" }), $("#sidebar").css({ display: "inline-block" })) : $("." + e).css({ display: "inline-block" }), "articles" != e && "columnist" != e || ("block" == $("#mobile_icons").css("display") ? $(".titleForOpinion").width($(".tiles").width() - $(".article_columnist").width() - 38) : $(".titleForOpinion").width(160)) }), ready_sharing(), $("#login_fb a").click(function (e) { e.preventDefault(), fb_login() }), $("#sticky_nav").hover(function () { clearTimeout(e), $("#sticky_publications").slideDown(200), social_ready = !1, "block" == $("#mobile_icons").css("display") ? $("#mobile-navig").css({ display: "block" }) : $("#mobile-navig").css({ display: "none" }) }, function () { e = setTimeout(function () { $("#sticky_publications").slideUp(200), $(".mobile-navig_subnav").slideUp(200) }, 500) }), $("#login_profile").click(function () { $("#searchbar").slideUp(200), $("#nav_profile").slideToggle(200), social_ready = !1 }); var o = -1; $(".poll_answer").click(function () { o = $(this).attr("targ") }), $("#poll_button").click(function () { whiteout_reset(), o < 0 ? ($("#floatingBarsG").css({ display: "none" }), $("#popup").css({ display: "block" }), $("#popup_message").text("Please select an answer first.")) : $.post(base_url + "poll_answer.php", "answer=" + o + "&id=" + $("#pollid").val(), function (e) { var o = jQuery.parseJSON(e); $("#floatingBarsG").css({ display: "none" }), $("#popup").css({ display: "block" }), $("#popup_message").text(o.message); for (var i = 0; i < 10; i += 1)$("#answer" + i).html(o["answer" + i] + "% - " + $("#answer" + i).text()); $("#poll_button").css({ display: "none" }) }) }), $("#mailing_submit").click(function (e) { e.preventDefault(), window.location.assign(base_url + "mailing-list") }), $("#login_forgot").click(function (e) { e.preventDefault(), $("#login_message").hide(), "" == $("#ps_email").val() ? $("#login_message").show().text("Please enter your email address.") : $.post("check_forget.php", "email=" + $("#ps_email").val(), function (e) { 0 == e ? $("#login_message").show().text("Email address not found.") : $("#login_message").show().text("Your new password has been emailed to you.") }) }) }), $(window).load(function () { if ("" == $("#geo_long").val()) console.log("no geo"); else { var e = $("#geo_short").val(), o = $("#geo_long").val(); console.log("geo: " + o), $.post(base_url + "geoarts.php", "short=" + e + "&long=" + o, function (e) { "0" != e && ($("#geo").append(e), "relative" == $("#static_cells").css("position") && 0 == rec_top && (rec_top = $("#static_cells").offset().top)) }) } rec_top = $("#static_cells").offset().top, $("#mobile_burger_drop").width($("#content").width()), "block" == $("#section_checker").css("display") && ($(".tiles, .typeNews").css({ display: "none" }), $(".late").css({ display: "inline-block" })), "block" == $("#mobile_icons").css("display") ? $(".titleForOpinion").width($(".tiles").width() - $(".article_columnist").width() - 38) : $(".titleForOpinion").width(160) }); var googleUser = {}, startApp = function () { gapi.load("auth2", function () { auth2 = gapi.auth2.init({ client_id: "901299274787-uhltbpsq076q893g1pbfe765frnelm5j.apps.googleusercontent.com", cookiepolicy: "single_host_origin" }), attachSignin(document.getElementById("login_gp")) }) }; function attachSignin(e) { console.log(e.id), auth2.attachClickHandler(e, {}, function (e) { whiteout_reset(), console.log("Signed in: " + e.getBasicProfile().getName()), console.log("ID: " + e.getBasicProfile().getId()), console.log("Name: " + e.getBasicProfile().getGivenName()), console.log("Name: " + e.getBasicProfile().getFamilyName()), console.log("Image URL: " + e.getBasicProfile().getImageUrl()), console.log("Email: " + e.getBasicProfile().getEmail()), $.post(base_url + "check_credentials.php", "gid=" + e.getBasicProfile().getId() + "&email=" + e.getBasicProfile().getEmail() + "&firstname=" + e.getBasicProfile().getGivenName() + "&lastname=" + e.getBasicProfile().getFamilyName() + "&remember=" + $("#ps_remember").prop("checked"), function (e) { console.log("credentials: " + e), "logged" == e.trim() || "added" == e.trim() ? location.reload() : ($("#floatingBarsG").css({ display: "none" }), $("#popup").css({ display: "block" }), $("#popup_message").text("Email address already in use.")) }) }, function (e) { alert(JSON.stringify(e, void 0, 2)) }) } function login_user() { var e = $("#ps_email").val(), o = $("#ps_password").val(); $("#login_message").css({ display: "none" }), $(".login_text").css({ borderColor: "#3c3c3c" }), "" != e && "" != o ? (whiteout_reset(), $.post(base_url + "check_login.php", "email=" + e + "&password=" + o + "&remember=" + $("#ps_remember").prop("checked"), function (e) { 1 == e ? location.reload() : ($("#floatingBarsG").css({ display: "none" }), $("#login").css({ display: "block" }), $(".login_text").css({ borderColor: "#f03" }), $("#login_message").css({ display: "block" }).text("Invalid username/password.")) })) : ("" == e && $("#ps_email").css({ borderColor: "#f03" }), "" == o && $("#ps_password").css({ borderColor: "#f03" }), $("#login_message").css({ display: "block" }).text("Required fields left blank.")) } function ready_sharing() { $(".fb_share_article").click(function (e) { e.preventDefault(), fb_share($(this).attr("fb_share")) }) } function fb_login() { console.log("fb login"), FB.getLoginStatus(function (e) { console.log("fb status: " + e.status), "connected" != e.status ? FB.login(function (e) { "connected" === e.status && testAPI() }, { scope: "public_profile,email" }) : testAPI() }) }